# 📜 漢字ローグライク — Game Design Document
> Last Updated: 2026-02-28 14:49

---

## 1. 🎮 ゲーム概要

### コンセプト
「漢字ローグライク」は、漢字の成り立ち（部首の合体）をメカニクスの中心に据えた
デッキ構築型ローグライクカードゲームです。

### コアループ
```
マップ進行 → 戦闘/イベント → 報酬(Gold) → デッキ強化(商店/道場/合体) → ボス討伐
```

### ビジュアルデザイン
- **背景**: 墨色(#1A1A1A)ベースの和風デザイン
- **マップ**: Slay the Spire風のボトムアップ型ルートマップ、背景に地形漢字が散りばめられた和紙風
- **カード**: 効果タイプごとに色分け（攻撃=赤、防御=青、回復=緑、バフ=黄、特殊=紫）
- **演出**: 合体時の吸い寄せ＆閃光、ダメージ時のシェイク＆ポップアップ（VFXManager管理）

### 属性（Element）システム
各カードは以下の属性を持ちます：

| Element | 和名 | 代表カード |
|---------|------|-----------|
| None | 無属性 | 口, 力, 人 等 |
| Wood | 木 | 木, 林, 森, 休, 柏, 松 |
| Fire | 火 | 火, 炎, 畑 |
| Earth | 土 | 田, 土, 圭 |
| Sun | 日 | 日, 明, 早, 東, 晶 |
| Moon | 月 | 月 |

---

## 2. 🗺️ 画面遷移とマップ仕様

### GameState（画面状態一覧）
| State | 画面 | 説明 |
|-------|------|------|
| `Map` | マップ画面 | ルート選択、次のノードへ進行 |
| `Battle` | 戦闘画面 | カードを使って敵と戦闘 |
| `Fusion` | 合体所 | カード2枚を合体して進化カードを獲得 |
| `Shop` | 商店 | ゴールドでカードを購入 |
| `Dojo` | 道場 | カードの追放/鍛錬 |
| `Event` | イベント | ランダムイベント |
| `GameOver` | ゲームオーバー | リトライ選択 |

### マップ構造（Slay the Spire型）
- **レイヤー数**: 7層（ボトム→トップ）
- **各層ノード数**: 2〜3ノード（ランダム分岐）
- **最終層**: 大将（Boss）固定
- **選択可能ノード**: 点滅アニメーションで強調表示
- **大将ノード**: 1.5倍サイズで表示

### ノードタイプ一覧
| 漢字 | タイプ | 色 | 説明 |
|------|--------|-----|------|
| 戦闘 | `Battle` | 青 | 通常敵との戦闘。勝利でGold獲得 |
| 強敵 | `Elite` | 橙 | 強力な敵。報酬が多い |
| 商店 | `Shop` | 緑 | Goldを消費してカードを購入。3枚候補を表示 |
| 事件 | `Event` | 紫 | ランダムイベント |
| 大将 | `Boss` | 赤 | 各マップ最終ノード。討伐で次エリアへ |
| 道場 | `Dojo` | 褐 | カードの追放(10G)または鍛錬(15G, 攻撃/防御+2) |

---

## 3. ⚔️ 戦闘システムと操作仕様

### 基本パラメータ
- **初期HP**: 50
- **初期マナ**: 3/ターン
- **手札上限**: 5枚
- **初期Gold**: 50G
- **合体コスト**: 20G（道場での合体時）

### ターン進行
1. **プレイヤーターン**: マナを消費してカードを使用
2. **ターン終了**: 「終」ボタンを押す or マナが尽きたら任意で終了
3. **敵ターン**: 敵が自動で攻撃（attackPower分のダメージ）
4. **スタン状態**: 敵がスタン中は敵ターンをスキップし、スタンを解除
5. **繰り返し**: 敵HPが0になるか、プレイヤーHPが0になるまで

### カード操作（Drag & Drop）
カードは `CardController` で制御されるドラッグ＆ドロップ方式です。

| 操作 | ドロップ先 | 効果 |
|------|-----------|------|
| ドラッグ→敵 | Tag `Enemy` | カード効果発動（攻撃/回復/バフ等） |
| ドラッグ→カード | Tag `Card` | 合体判定→成功で進化カード生成 |
| ドラッグ→何もない | - | 手札に戻る |

### 合体判定フロー（バトル中）
1. カードAをカードBにドラッグ＆ドロップ
2. `GameManager.FindFusionResult(A.cardId, B.cardId)` でレシピ検索
3. レシピが存在 → VFX演出（吸い寄せ→閃光→消滅→新カード出現）
4. 手札からA,Bを除去し、結果カードを手札に追加
5. レシピ未存在 → カードが元の位置に戻る

### ホバー時プレビュー
- ドラッグ中のカードが別のカードに重なると、合体可能なら黄色発光＋結果漢字を表示
- 通常ホバー時はカードが10px上に浮き上がる

### 効果タイプ別ダメージ計算
| EffectType | 計算式 | 備考 |
|-----------|--------|------|
| `Attack` | `effectValue + attackModifier + playerAttackBuff` | 単体ダメージ |
| `AttackAll` | 同上 | 全体ダメージ（将来の複数敵対応） |
| `Defense` | `effectValue + defenseModifier` | 防御バフ加算 |
| `Heal` | `effectValue` | HP回復（上限まで） |
| `Buff` | `effectValue` | 攻撃バフ加算 |
| `Draw` | `effectValue` 枚 | デッキからドロー |
| `Stun` | - | 敵の次ターンをスキップ |
| `Special` | `effectValue`ダメージ + `effectValue`回復 | 複合効果 |

### VFX演出（VFXManager）
| 演出 | タイミング | 詳細 |
|------|-----------|------|
| 合体シーケンス | 合体成功時 | 2枚が中央に吸い寄せ→縮小→閃光→新カードSpawn |
| ダメージ | 攻撃ヒット時 | 敵画像シェイク + 赤フラッシュ + ダメージ数値ポップ |
| Spawn | 新カード出現時 | AnimationCurve適用のボヨヨン出現 |

---

## 4. 🏗️ スクリプト・アーキテクチャ

### Core（コアロジック）
| Script | 役割 |
|--------|------|
| `BattleManager` | 戦闘ロジック（カード効果適用、敵ターン、勝敗判定、スタン管理）。シングルトン |
| `GameManager` | ゲーム全体の状態管理（HP/マナ/Gold/デッキ/手札/合成辞書）。シングルトン |
| `KanjiFusionEngine` | 合体ロジックのラッパー（FusionDatabase経由でレシピ検索） |
| `MapManager` | Slay the Spire風ルートマップ生成/表示/ノードクリック処理。和風デザイン |
| `VFXManager` | 全VFX演出管理（合体・ダメージ・Spawn）。Coroutine + AnimationCurve。シングルトン |

### Data（データ構造/ScriptableObject）
| Script | 役割 |
|--------|------|
| `EnemyData` | 敵キャラクターのデータ構造（HP/攻撃力/名前/説明） |
| `KanjiCardData` | 漢字カードのデータ構造（ScriptableObject）。属性(Element)・効果タイプ・鍛錬modifier含む |
| `KanjiFusionDatabase` | 全レシピのデータベース。複数結果対応キャッシュ＋分解用逆引き搭載 |
| `KanjiFusionRecipe` | 合成レシピ定義（2枚/3枚対応）。素材→結果のマッピング |

### UI（画面・インタラクション）
| Script | 役割 |
|--------|------|
| `BattleFusionArea` | (説明なし) |
| `BattleUI` | 戦闘画面UI管理。CardController生成/手札更新/ステータス表示/ターン終了ボタン |
| `CardController` | カードのドラッグ＆ドロップ制御。敵へ攻撃、カードへ合体、ホバープレビュー実装 |
| `CardUI` | カードUI要素保持（商店/道場用の軽量版） |
| `DeckEditUI` | 道場UI。「追放」(10G)でカード除去、「鍛錬」(15G)でAttack/Defense+2永続強化 |
| `DeckViewerUI` | (説明なし) |
| `EncyclopediaManager` | (説明なし) |
| `FusionSelectionUI` | (説明なし) |
| `FusionUI` | 合体所UI。2スロット選択→結果プレビュー→Gold消費で合体実行 |
| `KanjiEncyclopediaUI` | (説明なし) |
| `ShopUI` | 商店UI。ランダム3枚表示→Gold消費で購入→売切表示 |

### Editor（開発ツール）
| Script | 役割 |
|--------|------|
| `GameDesignDocGenerator` | 本ドキュメントを自動生成するエディタツール |
| `ProjectSetupTool` | ワンクリックでシーン全体を構築（カード/レシピ/敵/UI/VFX生成） |

### シングルトン管理
| Class | アクセス | 永続化 |
|-------|---------|--------|
| `GameManager` | `GameManager.Instance` | Scene内 |
| `BattleManager` | `BattleManager.Instance` | Scene内 |
| `VFXManager` | `VFXManager.Instance` | Scene内 |

---

## 5. 🎴 全カード一覧（Card Database）

### 基礎カード（素材）
| ID | 漢字 | 属性 | コスト | タイプ | 効果値 | 説明 |
|---|---|---|---|---|---|---|
| 1 | **木** | Wood | 1 | Attack | 3 | 木の力で敵に3ダメージ |
| 1 | **木** | Wood | 1 | Attack | 3 | 木の力で敵に3ダメージ |
| 4 | **日** | Sun | 1 | Heal | 3 | 太陽の光でHPを3回復 |
| 4 | **日** | Sun | 1 | Heal | 3 | 太陽の光でHPを3回復 |
| 5 | **月** | Moon | 1 | Defense | 3 | 月の守りで防御力+3 |
| 5 | **月** | Moon | 1 | Defense | 3 | 月の守りで防御力+3 |
| 7 | **力** | - | 1 | Buff | 2 | 力を高めて攻撃力+2 |
| 7 | **力** | - | 1 | Buff | 2 | 力を高めて攻撃力+2 |
| 8 | **火** | Fire | 1 | Attack | 4 | 炎の力で敵に4ダメージ |
| 8 | **火** | Fire | 1 | Attack | 4 | 炎の力で敵に4ダメージ |
| 9 | **田** | Earth | 1 | Defense | 2 | 田んぼの土で防御+2 |
| 9 | **田** | Earth | 1 | Defense | 2 | 田んぼの土で防御+2 |
| 10 | **口** | - | 1 | Draw | 1 | 口を開けてカードを1枚引く |
| 10 | **口** | - | 1 | Draw | 1 | 口を開けてカードを1枚引く |
| 11 | **十** | - | 1 | Attack | 2 | 十字斬りで敵に2ダメージ |
| 11 | **十** | - | 1 | Attack | 2 | 十字斬りで敵に2ダメージ |
| 12 | **大** | - | 2 | Attack | 5 | 大きく構えて敵に5ダメージ |
| 12 | **大** | - | 2 | Attack | 5 | 大きく構えて敵に5ダメージ |
| 13 | **土** | Earth | 1 | Defense | 3 | 土壁を作って防御+3 |
| 13 | **土** | Earth | 1 | Defense | 3 | 土壁を作って防御+3 |
| 22 | **人** | - | 1 | Attack | 3 | 人の手で微弱な3ダメージ |
| 22 | **人** | - | 1 | Attack | 3 | 人の手で微弱な3ダメージ |
| 23 | **目** | - | 1 | Draw | 2 | 目を凝らして2枚ドロー |
| 23 | **目** | - | 1 | Draw | 2 | 目を凝らして2枚ドロー |
| 24 | **白** | - | 1 | Defense | 4 | 白壁で防御+4 |
| 24 | **白** | - | 1 | Defense | 4 | 白壁で防御+4 |
| 25 | **公** | - | 2 | Attack | 4 | 公平に4ダメージ |
| 25 | **公** | - | 2 | Attack | 4 | 公平に4ダメージ |
| 26 | **民** | - | 1 | Defense | 3 | 民の結束で防御+3 |
| 26 | **民** | - | 1 | Defense | 3 | 民の結束で防御+3 |

### 合体カード（Fusion Result）
| ID | 漢字 | 属性 | コスト | タイプ | 効果値 | 説明 |
|---|---|---|---|---|---|---|
| 2 | **林** | Wood | 1 | Attack | 7 | 林の力で敵に7ダメージ |
| 2 | **林** | Wood | 1 | Attack | 7 | 林の力で敵に7ダメージ |
| 3 | **森** | Wood | 2 | Attack | 15 | 森の力で敵に15ダメージ |
| 3 | **森** | Wood | 2 | Attack | 15 | 森の力で敵に15ダメージ |
| 6 | **明** | Sun | 2 | Special | 5 | 日月の力で5ダメージ+3回復 |
| 6 | **明** | Sun | 2 | Special | 5 | 日月の力で5ダメージ+3回復 |
| 14 | **畑** | Fire | 2 | Special | 3 | 火と土の恵みで3ダメージ+3防御 |
| 14 | **畑** | Fire | 2 | Special | 3 | 火と土の恵みで3ダメージ+3防御 |
| 15 | **加** | - | 2 | Buff | 2 | 力を加えて攻撃力+2 |
| 15 | **加** | - | 2 | Buff | 2 | 力を加えて攻撃力+2 |
| 16 | **男** | - | 2 | Attack | 8 | 畑仕事の力で8ダメージ |
| 16 | **男** | - | 2 | Attack | 8 | 畑仕事の力で8ダメージ |
| 17 | **回** | - | 2 | Draw | 2 | ぐるぐる回して2枚ドロー |
| 17 | **回** | - | 2 | Draw | 2 | ぐるぐる回して2枚ドロー |
| 18 | **古** | - | 1 | Heal | 4 | 古の知恵でHP4回復 |
| 18 | **古** | - | 1 | Heal | 4 | 古の知恵でHP4回復 |
| 19 | **本** | Wood | 2 | Buff | 3 | 基本に立ち返り攻撃力+3 |
| 19 | **本** | Wood | 2 | Buff | 3 | 基本に立ち返り攻撃力+3 |
| 20 | **圭** | Earth | 2 | Defense | 6 | 土を重ねて防御+6 |
| 20 | **圭** | Earth | 2 | Defense | 6 | 土を重ねて防御+6 |
| 21 | **早** | Sun | 2 | Draw | 1 | 早業で1ドロー |
| 21 | **早** | Sun | 2 | Draw | 1 | 早業で1ドロー |
| 27 | **休** | Wood | 2 | Heal | 8 | 木陰で休んでHP8回復 |
| 27 | **休** | Wood | 2 | Heal | 8 | 木陰で休んでHP8回復 |
| 28 | **相** | Wood | 2 | Draw | 3 | 相手を見て3枚ドロー |
| 28 | **相** | Wood | 2 | Draw | 3 | 相手を見て3枚ドロー |
| 29 | **柏** | Wood | 2 | Defense | 12 | 柏の盾で防御+12 |
| 29 | **柏** | Wood | 2 | Defense | 12 | 柏の盾で防御+12 |
| 30 | **松** | Wood | 3 | AttackAll | 10 | 松の棘で敵全体に10ダメージ |
| 30 | **松** | Wood | 3 | AttackAll | 10 | 松の棘で敵全体に10ダメージ |
| 31 | **果** | Wood | 2 | Heal | 6 | 果実を食べてHP6回復 |
| 31 | **果** | Wood | 2 | Heal | 6 | 果実を食べてHP6回復 |
| 32 | **東** | Sun | 2 | Buff | 3 | 日が昇り攻撃力+3 |
| 32 | **東** | Sun | 2 | Buff | 3 | 日が昇り攻撃力+3 |
| 33 | **困** | - | 2 | Stun | 1 | 囲んで敵を1ターンスタン |
| 33 | **困** | - | 2 | Stun | 1 | 囲んで敵を1ターンスタン |
| 34 | **炎** | Fire | 2 | Attack | 12 | 二つの炎で敵に12ダメージ |
| 34 | **炎** | Fire | 2 | Attack | 12 | 二つの炎で敵に12ダメージ |
| 35 | **眠** | - | 2 | Stun | 1 | 催眠で敵を1ターンスタン |
| 35 | **眠** | - | 2 | Stun | 1 | 催眠で敵を1ターンスタン |
| 36 | **品** | - | 2 | Draw | 3 | 三つの口で3枚ドロー |
| 36 | **品** | - | 2 | Draw | 3 | 三つの口で3枚ドロー |
| 37 | **晶** | Sun | 3 | Heal | 15 | 三つの太陽でHP15回復 |
| 37 | **晶** | Sun | 3 | Heal | 15 | 三つの太陽でHP15回復 |
| 38 | **罠** | - | 2 | AttackAll | 5 | 罠を仕掛けて敵に全体5ダメージ |

---

## 6. 🔥 合体レシピ一覧（Fusion Recipes）

### 2枚合体
| 素材A | + | 素材B | = | 結果 | 効果 |
|-------|---|-------|---|------|------|
| 火 | + | 田 | → | **畑** | 火と土の恵みで3ダメージ+3防御 |
| 火 | + | 火 | → | **炎** | 二つの炎で敵に12ダメージ |
| 火 | + | 田 | → | **畑** | 火と土の恵みで3ダメージ+3防御 |
| 火 | + | 火 | → | **炎** | 二つの炎で敵に12ダメージ |
| 口 | + | 口 | → | **回** | ぐるぐる回して2枚ドロー |
| 口 | + | 木 | → | **困** | 囲んで敵を1ターンスタン |
| 口 | + | 木 | → | **困** | 囲んで敵を1ターンスタン |
| 口 | + | 口 | → | **回** | ぐるぐる回して2枚ドロー |
| 十 | + | 口 | → | **古** | 古の知恵でHP4回復 |
| 十 | + | 口 | → | **古** | 古の知恵でHP4回復 |
| 人 | + | 木 | → | **休** | 木陰で休んでHP8回復 |
| 人 | + | 木 | → | **休** | 木陰で休んでHP8回復 |
| 大 | + | 木 | → | **本** | 基本に立ち返り攻撃力+3 |
| 大 | + | 木 | → | **本** | 基本に立ち返り攻撃力+3 |
| 田 | + | 木 | → | **果** | 果実を食べてHP6回復 |
| 田 | + | 木 | → | **果** | 果実を食べてHP6回復 |
| 土 | + | 土 | → | **圭** | 土を重ねて防御+6 |
| 土 | + | 土 | → | **圭** | 土を重ねて防御+6 |
| 日 | + | 十 | → | **早** | 早業で1ドロー |
| 日 | + | 木 | → | **東** | 日が昇り攻撃力+3 |
| 日 | + | 月 | → | **明** | 日月の力で5ダメージ+3回復 |
| 日 | + | 十 | → | **早** | 早業で1ドロー |
| 日 | + | 木 | → | **東** | 日が昇り攻撃力+3 |
| 日 | + | 月 | → | **明** | 日月の力で5ダメージ+3回復 |
| 木 | + | 目 | → | **相** | 相手を見て3枚ドロー |
| 木 | + | 白 | → | **柏** | 柏の盾で防御+12 |
| 木 | + | 目 | → | **相** | 相手を見て3枚ドロー |
| 木 | + | 白 | → | **柏** | 柏の盾で防御+12 |
| 木 | + | 木 | → | **林** | 林の力で敵に7ダメージ |
| 木 | + | 公 | → | **松** | 松の棘で敵全体に10ダメージ |
| 木 | + | 木 | → | **林** | 林の力で敵に7ダメージ |
| 木 | + | 公 | → | **松** | 松の棘で敵全体に10ダメージ |
| 目 | + | 民 | → | **眠** | 催眠で敵を1ターンスタン |
| 目 | + | 民 | → | **罠** | 罠を仕掛けて敵に全体5ダメージ |
| 力 | + | 口 | → | **加** | 力を加えて攻撃力+2 |
| 力 | + | 田 | → | **男** | 畑仕事の力で8ダメージ |
| 力 | + | 口 | → | **加** | 力を加えて攻撃力+2 |
| 力 | + | 田 | → | **男** | 畑仕事の力で8ダメージ |
| 林 | + | 木 | → | **森** | 森の力で敵に15ダメージ |
| 林 | + | 木 | → | **森** | 森の力で敵に15ダメージ |

### 3枚合体
| 素材A | + | 素材B | + | 素材C | = | 結果 | 効果 |
|-------|---|-------|---|-------|---|------|------|
| 口 | + | 口 | + | 口 | → | **品** | 三つの口で3枚ドロー |
| 日 | + | 日 | + | 日 | → | **晶** | 三つの太陽でHP15回復 |
| 口 | + | 口 | + | 口 | → | **品** | 三つの口で3枚ドロー |
| 日 | + | 日 | + | 日 | → | **晶** | 三つの太陽でHP15回復 |

---

## 7. ⚙️ ゲーム設定

### 初期デッキ構成
| カード | 枚数 |
|--------|------|
| 木 | x4 |
| 火 | x2 |
| 日 | x2 |
| 月 | x1 |
| 力 | x1 |

### 敵キャラクター
| Name | Kanji | HP | ATK | Type |
|------|-------|-----|-----|------|
| スライム漢字 | 字 | 15 | 3 | Normal |
| 妖怪文字 | 怪 | 20 | 5 | Normal |
| 鬼 | 鬼 | 30 | 7 | Elite |
| 龍 | 龍 | 50 | 10 | Boss |

### 商店対象カード
> 基礎カード（非合体結果）がランダムに3枚表示されます。
対象: 木, 木, 日, 日, 月, 月, 力, 力, 火, 火, 田, 田, 口, 口, 十, 十, 大, 大, 土, 土, 人, 人, 目, 目, 白, 白, 公, 公, 民, 民

